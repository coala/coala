dependencies:
  pre:
    # Stop some services that circle-ci starts on it's own that we don't need
    - sudo service mysql stop
    - sudo service mongodb stop
    # Set the python version
    - sh .misc/choose_python_version.sh
    # Disable the virtuelenv circleci spawns on it's own
    - sed -i '/source \/home\/ubuntu\/virtualenvs\//d' ~/.circlerc
  override:
    - sh .misc/.install.sh

test:
  override:
    - sh .misc/run_tests.sh:
        parallel: true
    - python setup.py install:
        parallel: true
    - coala -c .misc/.ci_coafile:
        parallel: true
  post:
    - sh .misc/.success.coverage.sh:
        parallel: true
