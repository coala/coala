dependencies:
  cache_directories:
    - ~/.pyenv/versions/3.4.3
    - ~/.pyenv/versions/3.5.1
    - ~/nltk_data
    - ~/.scspell
    - docs/_build
  pre:
    - sed -i '/source \/home\/ubuntu\/virtualenvs\//d' ~/.circlerc
    - nvm alias default node
    - npm install -g csslint
  override:
    - bash .misc/deps.sh

test:
  override:
    - py.test:
        parallel: true
    - pip install pip setuptools -U:
        parallel: true
    - python setup.py install:
        parallel: true
    - pip install coala-bears[alldeps] --pre -U:
        parallel: true
        timeout: 1800  # Allow 30 mins
    - pip install -r docs-requirements.txt:
        parallel: true
    - python .misc/generate_dictionary.py:
        parallel: true
    - coala --non-interactive:
        parallel: true
    - codecov:
        parallel: true
    - python setup.py docs
